<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Ideal Weight Calculator (updated)</title>
	<style>
		body {
			font-family: 'Segoe UI', Tahoma, Geneva;
			background-color: #eaeaea;
			color: #333; 
			padding: 40px;
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		h1 { margin-bottom: 20px; color: #333; }
		.container { background: #fff; padding: 32px 40px; border-radius: 16px; box-shadow: 0 4px 8px rgba(0,0,0,0.2); max-width: 600px; width: 92%; }
		label { font-weight: 500; display:block; margin-top:12px }
		.height-inputs { display:flex; gap:8px }
		input[type=number] { margin-top: 5px; padding: 8px 12px; width: 100%; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
		.input-row { display:flex; gap:8px; align-items:center }
		.input-row .half { flex:1 }
		.select, select { margin-top:5px }
		button { margin-top: 16px; background-color: #2b6cb0; color: white; border: none; padding: 12px 16px; font-size: 16px; border-radius: 6px; cursor: pointer; transition: background-color 0.3s; }
		button:hover { background-color: #2c5282 }
		#result { margin-top: 24px; font-size: 18px; font-weight: 600; color: #2f855a; text-align: center; }
		.small { font-size:13px; color:#666 }
		.unit-label { min-width:44px; text-align:right; display:inline-block; margin-left:6px }
		.horizontal-group { display: flex; gap: 16px; flex-wrap: wrap; /* allows wrapping on small screens */ }
		.field { display: flex; flex-direction: column; min-width: 50px; }
	</style>
</head>
<body>
	<h1>YOUR Ideal Weight Calculator</h1>
	<div class="container">

		<!-- Unit switch -->
		<div class="switch input-row">
		  <input type="checkbox" id="unitSwitch">
		  <label for="unitSwitch">Use Imperial (ft/in, in)</label>
		</div>

		<!-- Height (Metric) -->
		<div id="metricInput">
		  <label for="heightCm">Height (cm):</label>
		  <input type="number" id="heightCm" min="103" max="243" value="172">
		</div>

		<!-- Height (Imperial) -->
		<div id="imperialInput" style="display:none;">
		  <label for="heightFt">Height:</label>
		  <div class="height-inputs">
			<input type="number" id="heightFt" min="3" max="8" value="5"> 
			<input type="number" id="heightIn" min="0" max="11" value="8">
		  </div>
		</div>
		
		<div id="wingspanCmDiv">
			<label for="wingspanCmLabel">Wingspan (cm):</label>
			<input type="number" id="wingspanCm" min="100" max="260" value="172">
		</div>
		
		<div id="wingspanImperial" style="display:none;">
		  <label>Wingspan:</label>
		  <div class="height-inputs">
			<input type="number" id="wingspanFt" min="3" max="9" value="5">
			<input type="number" id="wingspanIn" min="0" max="11" value="8">
		  </div>
		</div>
		

		<div class="horizontal-group">
		  <div class="field">
			<label for="gender">Gender:</label>
			<select id="gender">
			  <option value="male">Male</option>
			  <option value="female">Female</option>
			</select>
		  </div>

		  <div class="field">
			<label for="ethnicity">Population:</label>
			<select id="ethnicity">
			  <option value="0">Caucasian</option>
			  <option value="0.02">African American</option>
			  <option value="-0.02">Latin American</option>
			  <option value="0.01">East African</option>
			  <option value="0.03">West African</option>
			  <option value="-0.01">Central Asian</option>
			  <option value="-0.04">East Asian</option>
			  <option value="-0.05">South Asian</option>
			</select>
		  </div>

		  <div class="field">
			<label for="torso">Torso Length:</label>
			<select id="torso">
			  <option value="0">Medium</option>
			  <option value="-0.03">Short</option>
			  <option value="0.03">Long</option>
			</select>
		  </div>
		</div>

		<!-- Years of experience replaces hypertrophy select -->
		<label for="yearsExperience">Years of lifting experience:</label>
		<input type="number" id="yearsExperience" min="0" max="7" step="0.1" value="0">
		<div class="small">This value will be interpolated against preset muscularity points (0 -> untrained ... 7 -> late advanced).</div>

		<!-- Wrist & Ankle inputs replace frame size -->
		<label>Wrist circumference:</label>
		<div class="input-row">
		  <input type="number" id="wristCm" class="half" min="10" max="25" step="0.1" value="17.5">
		  <div class="unit-label" id="wristUnit">cm</div>
		</div>

		<label>Ankle circumference:</label>
		<div class="input-row">
		  <input type="number" id="ankleCm" class="half" min="12" max="35" step="0.1" value="23.0">
		  <div class="unit-label" id="ankleUnit">cm</div>
		</div>
		
		<button onclick="calculateWeight()">Calculate</button>
		
		<p></p>
		<h2 id="result">Ideal Weight Range will be here.</h2>
	</div>

<script>
	// --- helper conversions ---
	function cmToFeetInches(cm) {
	  let totalInches = cm / 2.54;
	  let feet = Math.floor(totalInches / 12);
	  let inches = Math.round(totalInches % 12);
	  if (inches === 12) { feet++; inches = 0; }
	  return [feet, inches];
	}
	function feetInchesToCm(feet, inches) {
	  return Math.round((feet * 12 + inches) * 2.54);
	}
	function cmToInches(cm) { return +(cm / 2.54).toFixed(2); }
	function inchesToCm(inches) { return +(inches * 2.54).toFixed(1); }

	// --- percentile tables (by gender) ---
	const percentiles = [1,5,15,25,50,75,85,95,99];

	const maleWrist = [15.6,16.2,16.7,17.0,17.6,18.2,18.5,19.1,19.8];
	const maleAnkle = [19.8,20.6,21.5,21.9,22.8,23.9,24.4,25.4,26.8];

	const femaleWrist = [13.8,14.2,14.7,15.0,15.4,16.0,16.3,16.8,17.4];
	const femaleAnkle = [18.5,19.3,20.0,20.5,21.5,22.5,23.1,24.2,25.5];

	function getPercentileFromValue(v, arr) {
		// arr should be increasing; percentiles aligns with `percentiles` array
		if (v <= arr[0]) return percentiles[0];
		if (v >= arr[arr.length-1]) return percentiles[percentiles.length-1];
		for (let i=0;i<arr.length-1;i++) {
			if (v >= arr[i] && v <= arr[i+1]) {
				const t = (v - arr[i]) / (arr[i+1] - arr[i]);
				return percentiles[i] + t * (percentiles[i+1] - percentiles[i]);
			}
		}
		return 50; // fallback
	}

	function lerp(a,b,t){ return a + (b-a)*t }

	// --- muscle keypoints (years -> muscle multiplier) ---
	const muscleKeyMale = [
	  { y: 0,    v: -0.08 },
	  { y: 0.25, v: -0.04 },
	  { y: 0.5,  v: -0.01 },
	  { y: 1,    v:  0.03 },
	  { y: 2,    v:  0.08 },
	  { y: 3,    v:  0.12 },
	  { y: 5,    v:  0.155 },
	  { y: 7,    v:  0.175 },
	  { y: 10,   v:  0.20 },
	];

	const muscleKeyFemale = [
	  { y: 0,    v: -0.08 },
	  { y: 0.25, v: -0.05 },
	  { y: 0.5,  v: -0.03 },
	  { y: 1,    v: -0.01 },
	  { y: 2,    v:  0.03 },
	  { y: 3,    v:  0.06 },
	  { y: 5,    v:  0.09 },
	  { y: 7,    v:  0.105 },
	  { y: 10,   v:  0.123 },
	];

	function muscleFromYears(years, gender){
		const y = Math.min(Math.max(years, 0), 10);
		const key = (gender === "female") ? muscleKeyFemale : muscleKeyMale;

		for (let i = 1; i < key.length; i++){
			if (y <= key[i].y){
				const prev = key[i - 1];
				const next = key[i];

				const t = (y - prev.y) / (next.y - prev.y);
				return prev.v + t * (next.v - prev.v);
			}
		}

		// fallback (should never really hit)
		return key[key.length - 1].v;
	}

	// --- UI references ---
	const switchInput = document.getElementById('unitSwitch');
	const metricInput = document.getElementById('metricInput');
	const imperialInput = document.getElementById('imperialInput');
	const heightCm = document.getElementById('heightCm');
	const heightFt = document.getElementById('heightFt');
	const heightIn = document.getElementById('heightIn');

	const wristCm = document.getElementById('wristCm');
	const ankleCm = document.getElementById('ankleCm');
	const wristUnit = document.getElementById('wristUnit');
	const ankleUnit = document.getElementById('ankleUnit');

	// When toggling units we convert wrist/ankle and height accordingly
	switchInput.addEventListener('change', () => {
	  if (switchInput.checked) {
		// to imperial
		const [wFt, wIn] = cmToFeetInches(parseFloat(wingspanCm.value || heightCm.value));
		wingspanFt.value = wFt;
		wingspanIn.value = wIn;
		document.getElementById('wingspanImperial').style.display = 'block';
		document.getElementById('wingspanCmDiv').style.display = 'none';

		const [ft, inches] = cmToFeetInches(parseFloat(heightCm.value || 172));
		heightFt.value = ft; heightIn.value = inches;
		metricInput.style.display = 'none'; imperialInput.style.display = 'block';

		// convert wrist/ankle cm -> inches (allow decimals)
		wristCm.value = +( (parseFloat(wristCm.value) || 0) / 2.54 ).toFixed(2);
		ankleCm.value = +( (parseFloat(ankleCm.value) || 0) / 2.54 ).toFixed(2);
		wristUnit.innerText = 'in'; ankleUnit.innerText = 'in';
	  } else {
		// to metric
		wingspanCm.value = feetInchesToCm(
			parseInt(wingspanFt.value || 5),
			parseInt(wingspanIn.value || 8)
		);
		document.getElementById('wingspanImperial').style.display = 'none';
		document.getElementById('wingspanCmDiv').style.display = 'block';
		
		const cm = feetInchesToCm(parseInt(heightFt.value || 5), parseInt(heightIn.value || 8));
		heightCm.value = cm;
		imperialInput.style.display = 'none'; metricInput.style.display = 'block';

		wristCm.value = +( (parseFloat(wristCm.value) || 0) * 2.54 ).toFixed(1);
		ankleCm.value = +( (parseFloat(ankleCm.value) || 0) * 2.54 ).toFixed(1);
		wristUnit.innerText = 'cm'; ankleUnit.innerText = 'cm';
	  }
	});

	// --- base weights (unchanged) ---
	const maleBaseWeights = {
				103: [22.9, 25.8],
				104: [23.3, 26.2],
				105: [23.7, 26.7],
				106: [24.1, 27.1],
				107: [24.5, 27.6],
				108: [24.9, 28.0],
				109: [25.3, 28.5],
				110: [25.7, 28.9],
				111: [26.1, 29.4],
				112: [26.5, 29.8],
				113: [26.9, 30.3],
				114: [26.3, 29.6],
				115: [26.7, 30.0],
				116: [27.1, 30.5],
				117: [27.5, 30.9],
				118: [27.9, 31.4],
				119: [28.3, 31.8],
				120: [28.7, 32.3],
				121: [29.1, 32.7],
				122: [29.5, 33.2],
				123: [30.0, 33.8],
				124: [30.5, 34.3],
				125: [31.0, 34.9],
				126: [31.5, 35.4],
				127: [32.0, 36.0],
				128: [32.5, 36.6],
				129: [33.0, 37.1],
				130: [33.6, 37.8],
				131: [34.2, 38.5],
				132: [34.8, 39.2],
				133: [35.4, 39.8],
				134: [36.0, 40.5],
				135: [36.7, 41.3],
				136: [37.4, 42.1],
				137: [38.1, 42.6],
				138: [38.8, 43.7],
				139: [39.5, 44.4],
				140: [40.2, 45.2],
				141: [41.0, 46.1],
				142: [41.8, 47.0],
				143: [42.6, 47.9],
				144: [43.4, 48.8],
				145: [44.2, 49.7],
				146: [45.0, 50.6],
				147: [45.8, 51.5],
				148: [46.6, 52.4],
				149: [47.4, 53.3],
				150: [48.2, 54.2],
				151: [49.0, 55.1],
				152: [49.8, 56.0],
				153: [50.6, 56.9],
				154: [51.4, 57.8],
				155: [52.2, 58.7],
				156: [53.0, 59.6],
				157: [53.8, 60.5],
				158: [54.6, 61.5],
				159: [55.4, 62.3],
				160: [56.2, 63.2],
				161: [57.0, 64.1],
				162: [57.8, 65.0],
				163: [58.6, 65.9],
				164: [59.4, 66.8],
				165: [60.2, 67.7],
				166: [61.0, 68.6],
				167: [61.8, 69.5],
				168: [62.6, 70.4],
				169: [63.4, 71.3],
				170: [64.2, 72.2],
				171: [65.0, 73.1],
				172: [65.8, 74.0],
				173: [66.4, 74.8],
				174: [67.2, 75.6],
				175: [68.0, 76.5],
				176: [68.8, 77.4],
				177: [69.6, 78.3],
				178: [70.4, 79.2],
				179: [71.2, 80.1],
				180: [72.0, 81.0],
				181: [72.8, 81.9],
				182: [73.6, 82.8],
				183: [74.4, 83.7],
				184: [75.2, 84.6],
				185: [76.0, 85.5],
				186: [76.9, 86.5],
				187: [77.8, 87.5],
				188: [78.7, 88.5],
				189: [79.6, 89.6],
				190: [80.5, 90.6],
				191: [81.4, 91.6],
				192: [82.3, 92.6],
				193: [83.2, 93.6],
				194: [84.1, 94.6],
				195: [85.0, 95.6],
				196: [85.9, 96.6],
				197: [86.8, 97.7],
				198: [87.7, 98.7],
				199: [88.6, 99.7],
				200: [89.5, 100.7],
				201: [90.4, 101.7],
				202: [91.3, 102.7],
				203: [92.2, 103.7],
				204: [93.1, 104.7],
				205: [94.0, 105.8],
				206: [95.0, 106.9],
				207: [96.0, 108.0],
				208: [97.0, 109.1],
				209: [98.0, 110.3],
				210: [99.0, 111.4],
				211: [100.0, 112.5],
				212: [101.0, 113.6],
				213: [102.0, 114.8],
				214: [103.0, 115.9],
				215: [104.0, 117.0],
				216: [105.1, 118.2],
				217: [106.2, 119.5],
				218: [107.3, 120.7],
				219: [108.4, 121.9],
				220: [109.5, 123.2],
				221: [110.6, 124.4],
				222: [111.7, 125.6],
				223: [112.8, 126.9],
				224: [113.9, 128.1],
				225: [115.0, 129.4],
				226: [116.2, 130.7],
				227: [117.4, 132.1],
				228: [118.6, 133.4],
				229: [119.8, 134.8],
				230: [121.0, 136.1],
				231: [122.15, 137.4],
				232: [123.3, 138.7],
				233: [124.45, 140.0],
				234: [125.6, 141.3],
				235: [126.75, 142.6],
				236: [127.9, 143.9],
				237: [129.05, 145.2],
				238: [130.3, 146.6],
				239: [131.5, 147.9],
				240: [132.7, 149.3],
				241: [133.9, 150.6],
				242: [135.1, 152.0],
				243: [136.3, 153.3],
			};


		const femaleBaseWeights = {
				103: [20.5, 24.0],
				104: [20.8, 24.4],
				105: [21.1, 24.7],
				106: [21.4, 25.1],
				107: [21.7, 25.4],
				108: [22.0, 25.8],
				109: [22.3, 26.1],
				110: [22.6, 26.5],
				111: [22.9, 26.8],
				112: [23.2, 27.2],
				113: [23.5, 27.5],
				114: [23.8, 27.9],
				115: [24.2, 28.4],
				116: [24.6, 28.8],
				117: [25.0, 29.3],
				118: [25.4, 29.8],
				119: [25.8, 30.2],
				120: [26.2, 30.7],
				121: [26.6, 31.2],
			  	122: [27.0, 31.6],
				123: [27.5, 32.2],
				124: [28.0, 32.8],
				125: [28.5, 33.4],
				126: [29.0, 34.0],
				127: [29.5, 34.5],
				128: [30.0, 35.1],
				129: [31.0, 36.3],
				130: [32.0, 37.5],
				131: [32.5, 38.1],
				132: [33.0, 38.7],
				133: [33.6, 39.4],
				134: [34.2, 40.1],
				135: [34.8, 40.8],
				136: [35.4, 41.4],
				137: [36.0, 42.2],
				138: [36.6, 42.9],
				139: [37.2, 43.6],
				140: [38.8, 45.5],
				141: [39.5, 46.3],
				142: [40.2, 47.1],
				143: [40.9, 47.9],
				144: [41.6, 48.7],
				145: [42.3, 49.5],
				146: [43.0, 50.4],
				147: [43.7, 51.2],
				148: [44.4, 52.0],
				149: [45.1, 52.8],
				150: [45.8, 53.6],
				151: [46.5, 54.5],
				152: [47.2, 55.3],
				153: [47.9, 56.1],
				154: [48.6, 56.9],
				155: [49.3, 57.7],
				156: [50.0, 58.6],
				157: [50.7, 59.4],
				158: [51.4, 60.2],
				159: [52.1, 61.0],
				160: [52.8, 61.8],
				161: [53.5, 62.7],
				162: [54.2, 63.5],
				163: [54.9, 64.3],
				164: [55.6, 65.1],
				165: [56.3, 65.9],
				166: [57.0, 66.8],
				167: [57.8, 67.7],
				168: [58.6, 68.7],
				169: [59.4, 69.6],
				170: [60.2, 70.5],
				171: [61.0, 71.4],
				172: [61.8, 72.4],
				173: [62.6, 73.3],
				174: [63.4, 74.2],
				175: [64.2, 75.1],
				176: [65.0, 76.1],
				177: [65.8, 77.0],
				178: [66.6, 78.0],
				179: [67.4, 78.9],
				180: [68.2, 79.8],
				181: [69.0, 80.8],
				182: [69.8, 81.7],
				183: [70.6, 82.7],
				184: [71.4, 83.6],
				185: [72.2, 84.6],
				186: [73.0, 85.6],
				187: [73.8, 86.6],
				188: [74.6, 87.5],
				189: [75.4, 88.4],
				190: [76.2, 89.3],
				191: [77.0, 90.3],
				192: [77.9, 91.2],
				193: [78.8, 92.3],
				194: [79.7, 93.4],
				195: [80.6, 94.5],
				196: [81.5, 95.4],
				197: [82.4, 96.5],
				198: [83.3, 97.6],
				199: [84.2, 98.6],
				200: [85.1, 99.7],
				201: [86.0, 100.8],
				202: [87.0, 102.0],
				203: [88.0, 103.1],
				204: [89.0, 104.2],
				205: [90.0, 105.4],
				206: [91.0, 106.6],
				207: [92.0, 107.7],
				208: [93.0, 108.9],
				209: [94.0, 110.0],
				210: [95.1, 111.4],
				211: [96.2, 112.7],
				212: [97.3, 114.0],
				213: [98.4, 115.3],
				214: [99.5, 116.6],
				215: [100.6, 117.9],
				216: [101.7, 119.2],
				217: [102.8, 120.5],
				218: [103.9, 121.8],
				219: [105.0, 123.0],
				220: [106.1, 124.3],
				221: [107.2, 125.6],
				222: [108.3, 126.9],
				223: [109.4, 128.2],
				224: [110.5, 129.5],
				225: [111.6, 130.8],
				226: [112.7, 132.1],
				227: [113.8, 133.4],
				228: [114.9, 134.7],
				229: [116.0, 136.0],
				230: [117.1, 137.3],
				231: [118.2, 138.6],
				232: [119.3, 139.9],
				233: [120.4, 141.2],
				234: [121.5, 142.5],
				235: [122.6, 143.8],
				236: [123.7, 145.0],
				237: [124.8, 146.3],
				238: [125.9, 147.6],
				239: [127.0, 148.9],
				240: [128.1, 150.2],
				241: [129.2, 151.5],
				242: [130.3, 152.7],
				243: [131.4, 153.9],
			};

	function computeFrameMultiplier(gender, wristValCm, ankleValCm){
		// choose arrays
		const wArr = gender === 'male' ? maleWrist : femaleWrist;
		const aArr = gender === 'male' ? maleAnkle : femaleAnkle;
		const wp = getPercentileFromValue(wristValCm, wArr);
		const ap = getPercentileFromValue(ankleValCm, aArr);
		const avgP = (wp + ap) / 2.0; // between ~1 and 99
		// map 1 -> -0.05, 99 -> +0.05
		const norm = (avgP - 1) / (99 - 1);
		const frameMul = lerp(-0.05, 0.05, Math.min(Math.max(norm,0),1));
		return frameMul;
	}

	function calculateWeight(){
		let height = 172;
		const gender = document.getElementById('gender').value;
		const years = parseFloat(document.getElementById('yearsExperience').value) || 0;
		let muscle = muscleFromYears(years, gender);
		const torso = parseFloat(document.getElementById('torso') ? document.getElementById('torso').value : 0) || 0;
		let ethnicity = parseFloat(document.getElementById('ethnicity').value) || 0;

		// --- wingspan → ape index ---
		let wingspan;

		if (switchInput.checked) {
		  wingspan = feetInchesToCm(
			parseInt(wingspanFt.value || heightFt.value),
			parseInt(wingspanIn.value || heightIn.value)
		  );
		} else {
		  wingspan = parseFloat(document.getElementById('wingspanCm').value) || height;
		}

		// ape index in cm
		const apeIndex = wingspan - height;

		// clamp to [-20, +20]
		const apeClamped = Math.max(-20, Math.min(20, apeIndex));

		// lerp: -20 → -0.02, +20 → +0.02
		const ape = lerp(-0.02, 0.02, (apeClamped + 20) / 40);

		const baseWeights = gender === 'male' ? maleBaseWeights : femaleBaseWeights;

		if (switchInput.checked) {
			height = feetInchesToCm(parseInt(heightFt.value || 5), parseInt(heightIn.value || 8));
			// current wrist/ankle inputs when imperial are in inches, convert to cm for calculations
			var wristCmVal = inchesToCm(parseFloat(wristCm.value || 0));
			var ankleCmVal = inchesToCm(parseFloat(ankleCm.value || 0));
		} else {
			height = parseInt(document.getElementById('heightCm').value) || 172;
			var wristCmVal = parseFloat(wristCm.value || 0);
			var ankleCmVal = parseFloat(ankleCm.value || 0);
		}

		// compute frame multiplier from wrist+ankle
		const frame = computeFrameMultiplier(gender, wristCmVal, ankleCmVal);

		// clamp height and check base weight availability
		if (!baseWeights[height]) {
			document.getElementById('result').innerText = 'Height out of range or not supported yet.';
			return;
		}

		const base = baseWeights[height];
		let minWeight = base[0];
		let maxWeight = base[1];

		// decrease race impact if muscle > 0
		if (muscle > 0) { ethnicity *= 0.75 }

		let totalMultiplier = getTotalMultiplier(height, muscle, torso, ape, ethnicity, frame);

		minWeight *= totalMultiplier; maxWeight *= totalMultiplier;

		const heightMeters = height / 100; const heightSqr = heightMeters * heightMeters;
		let FFMI = gender === 'male' ? (maxWeight * 0.8 / heightSqr) : (maxWeight * 0.7 / heightSqr);

		if (switchInput.checked) {
			document.getElementById('result').innerText = `Ideal Weight Range: ${(minWeight * 2.205).toFixed(1)} lb – ${(maxWeight * 2.205).toFixed(1)} lb, ${(FFMI.toFixed(1))} FFMI`;
		} else {
			document.getElementById('result').innerText = `Ideal Weight Range: ${minWeight.toFixed(1)} kg – ${maxWeight.toFixed(1)} kg, ${(FFMI.toFixed(1))} FFMI`;
		}
	}

	// --- keep original getTotalMultiplier function from your code ---
	function getTotalMultiplier(height, muscle, torso, ape, ethnicity, frame) {
	    const h = Math.min(Math.max(height, 134), 210);
	    let b, km, kt, kf, ke;
	    if (h <= 170) {
	        const t = (h - 134) / (170 - 134);
	        b  = lerp(1.0525, 1.0,    t);
	        km = lerp(1.15,   0.95,   t);
	        kt = lerp(2.04,   1.08,   t);
	        kf = lerp(1.2,    1.0,    t);
	        ke = 1.0;
	    } else if (h <= 180) {
	        const t = (h - 170) / (180 - 170);
	        b  = lerp(1.0,    1.01,   t);
	        km = lerp(0.95,   1.0,    t);
	        kt = lerp(1.08,   0.833,  t);
	        kf = 1.0;
	        ke = lerp(1.0,    0.8,    t);
	    } else if (h <= 190) {
	        const t = (h - 180) / (190 - 180);
	        b  = lerp(1.01,   1.02,   t);
	        km = 1.0;
	        kt = lerp(0.833,  0.667,  t);
	        kf = 1.0;
	        ke = lerp(0.8,    0.4,    t);
	    } else {
	        const t = (h - 190) / (210 - 190);
	        b  = lerp(1.02,   1.03,   t);
	        km = 1.0;
	        kt = lerp(0.667,  0.5,    t);
	        kf = 1.0;
	        ke = lerp(0.4,    0.2,    t);
	    }
	    const totalMultiplier = b + muscle * km + torso * kt + ape + ethnicity * ke + frame * kf;
	    return totalMultiplier;
	}

</script>
</body>
</html>


